# Архитектура решения

## Цель

Сделать Podkop со встроенными community-списками из вашего репозитория, чтобы пользователь выбирал их в UI (`Списки сообщества`), а не вставлял внешние URL вручную.

## Что изменено в форке Podkop

Изменения внесены в локальную копию: `_podkop_upstream/`.

### Backend (shell)

- `_podkop_upstream/podkop/files/usr/lib/constants.sh`
  - источник списков перенаправлен на:
    - `https://raw.githubusercontent.com/wester11/ru-net-blacklist/main/lists`
  - список допустимых community-тегов ограничен компактным набором:
    - `ai_all`
    - `gaming`
    - `social_networks`
    - `messengers_calls`
    - `video_audio_streaming`
    - `news_media`
    - `developer_platforms`
    - `cloud_storage`

- `_podkop_upstream/podkop/files/usr/bin/podkop`
  - community domain ruleset берется из:
    - `.../lists/<tag>/domains.srs`
  - community subnet list берется из:
    - `.../lists/<tag>/subnets.srs`
  - для подсетей используется общий nft set (`podkop_subnets`) для всех выбранных секций.

### LuCI UI

- `_podkop_upstream/luci-app-podkop/htdocs/luci-static/resources/view/podkop/main.js`
- `_podkop_upstream/fe-app-podkop/src/constants.ts`
  - список community-пунктов заменен на ваши секции.
  - названия секций сделаны на русском:
    - AI инструменты
    - Игры
    - Социальные сети
    - Мессенджеры и звонки
    - Видео и стриминг
    - Новости и медиа
    - Платформы для разработчиков
    - Облачные хранилища

- `_podkop_upstream/luci-app-podkop/htdocs/luci-static/resources/view/podkop/section.js`
  - ссылка в описании `Списки сообщества` указывает на:
    - `github.com/wester11/ru-net-blacklist`

### Дефолтный конфиг

- `_podkop_upstream/podkop/files/etc/config/podkop`
  - дефолтный community-список: `social_networks`.

## Что это дает пользователю

Пользователь в UI Podkop выбирает нужные секции в `Списки сообщества`, и Podkop автоматически тянет домены/подсети из вашего репозитория.
